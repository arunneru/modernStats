---
title: "chapter-clustering-validation"
author: "Ar"
date: '2022-07-19'
output: pdf_document
---

# Need for validation of clusters 
Clustering algorithms are designed such that they come out with a given number of clusters even if the underlying data is devoid of any such clusters.
We will see a criterion to assess the credibility of the clusters produced by any clustering algorithm.

## Within-groups sum of squared distances (WSS): 

$$
WSS_k =  \sum_{l=1}^k{\sum_{x_i \in {C_l}}{d^2(x_i, \overline{x_l})}}
$$

where, $k$ is the number of clusters and within the l-th cluster $C_l$, $x_l$ is the centre of mass.
We are interested in finding the *elbow* where there is a sudden drop in WSS_k as k is increased. 

```{r}
library("dplyr")
simdat <- lapply(c(0, 8), function(mx) {
    lapply(c(0, 8), function(my) {
        tibble(
            x = rnorm(100, mean = mx, sd = 2),
            y = rnorm(100, mean = my, sd = 2),
            class = paste(mx, my, sep = ":")
        )
    }) %>% bind_rows()
}) %>% bind_rows()

simdat
```


```{r}
library("tidyverse")
simdatxy <- simdat[, c("x", "y")]
ggplot(simdat, aes(x = x, y = y, col = class)) +
    geom_point() +
    coord_fixed()
```
```

```{r}
wss <- tibble(k = 1:8, value = NA_real_)
wss$value[1] <- sum(scale(simdatxy, scale = FALSE)^2)
for (i in 2:nrow(wss)) {
    km <- kmeans(simdatxy, centers = wss$k[i])
    wss$value[i] <- sum(km$withinss)
}

ggplot(wss, aes(x = k, y = value)) +
    geom_col()
```





```{r}
simdat.unif <- lapply(c(0, 8), function(mx) {
    lapply(c(0, 8), function(my) {
        tibble(
            x = runif(100, min = min(simdat$x), max = max(simdat$x)),
            y = runif(100, min = min(simdat$y), max = max(simdat$y)),
            class = "unif"
        )
    }) %>% bind_rows()jumping to the next codeblock in vs code
}) %>% bind_rows()

```


```{r}
simdatxy.unif <- simdat.unif[, c("x", "y")]
ggplot(simdat.unif, aes(x = x, y = y, col = class)) +
    geom_point() +
    coord_fixed()





```{r}
require(stats)
x <- matrix(1:10, ncol = 2)
centered.x <- scale(x, scale = FALSE)
```


```{r}
simdatxy <- simdat[, c("x", "y")]
```

```{r}
ggplot(simdat, aes(x = x, y = y, col = class)) + geom_point() + coord_fixed()
```


```{r}
summary(simdatxy)
```


```{r}
library("fpc")
library("cluster")
CH = tibble(
  k = 2:8,
  value = sapply(k, function(i) {
    p = pam(simdatxy, i)
    calinhara(simdatxy, p$cluster)
  })
)
ggplot(CH, aes(x = k, y = value)) + geom_line() + geom_point() +
  ylab("CH index")
```